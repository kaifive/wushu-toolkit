import{r as v,j as e}from"./index-DPPuFoIj.js";import{s as G,e as F,g as J}from"./sortStandings-DkvFZbCF.js";import{c as C}from"./calculatePercentage-DQl4Ag99.js";import{C as N}from"./CAlert--havsEJ7.js";import{C as W}from"./CAlertLink-CTpajGFK.js";import{C as m,a as i}from"./CRow-xYleieWj.js";import{C as b}from"./CWidgetStatsB-Deglql-Z.js";import{C as u,a as p}from"./CCardBody-BTRE22wJ.js";import{C as f}from"./CCardHeader-Z_LfyBUn.js";import{C as O,a as B,b as S,c as x,d as D,e as d}from"./CTable-CMCgTbMU.js";import{C as R,a as $}from"./CInputGroupText-C5r2fe0f.js";import{C as I}from"./CFormSelect-BeS1ada9.js";import{a as K}from"./index.es-BOLGEVhI.js";import{P as q}from"./PieChart-fljNJOxc.js";import"./DefaultLayout-DmIPwGoV.js";import"./CProgress-BftMloX1.js";import"./CFormControlWrapper-CxYcH3B2.js";import"./CFormControlValidation-1XEsXcnJ.js";import"./CFormLabel-C4TTxIm9.js";const me=()=>{const[a,c]=v.useState(""),[s,l]=v.useState(""),[t,h]=v.useState({athleteData:{},schools:[],loading:!0,error:null});v.useEffect(()=>{const r=()=>{J().then(n=>{h(n)}).catch(n=>{h({athleteData:{},schools:[],loading:!0,error:null})})};r();const o=setInterval(r,1*60*1e3);return()=>clearInterval(o)},[h]);const{athleteData:g,loading:H,error:L,syncDate:_}=t;let j=G(g);const k=j.filter(r=>r.gender==="Male").length,w=j.filter(r=>r.gender==="Female").length;let T=F;if(a!==""&&(T=z(F,a)),s!==""&&(j=j.filter(r=>r.events.some(o=>o.form===s))),H)return e.jsx("div",{children:"Loading..."});if(L)return e.jsxs(N,{color:"danger",children:["An error has occurred getting scores, refresh this page. If this problem continues to persist, contact Khai Nguyen and check the ",e.jsx(W,{href:"https://bowuu.com/all-results",target:"_blank",children:"Official Total Scores"}),"."]});let A=null;if(s==="")A=e.jsx(N,{color:"danger",children:"Select an Event."});else{let r=[],o=[];j.forEach(n=>{n.gender==="Male"?r.push(n):n.gender==="Female"&&o.push(n)}),A=e.jsxs(e.Fragment,{children:[e.jsxs(m,{xs:{gutter:3},children:[e.jsx(i,{xs:12,sm:6,xl:3,xxl:3,children:e.jsx(b,{className:"mb-3",color:"white",progress:{value:C(r.length,k)},text:"",title:"Number of Male Athletes",value:`${r.length} / ${k}`})}),e.jsx(i,{xs:12,sm:6,xl:3,xxl:3,children:e.jsx(b,{className:"mb-3",color:"white",progress:{value:C(y(r,s),10)},text:"",title:"Average Barehand Score",value:`${y(r,s)} / 10.00`})}),e.jsx(i,{xs:12,sm:6,xl:3,xxl:3,children:e.jsx(b,{className:"mb-3",color:"white",progress:{value:C(o.length,w)},text:"",title:"Number of Female Athletes",value:`${o.length} / ${w}`})}),e.jsx(i,{xs:12,sm:6,xl:3,xxl:3,children:e.jsx(b,{className:"mb-3",color:"white",progress:{value:C(y(o,s),10)},text:"",title:"Average Long Weapon Score",value:`${y(o,s)} / 10.00`})})]}),e.jsx("br",{}),e.jsxs(m,{xs:{gutter:3},children:[e.jsx(i,{xs:12,sm:12,xl:6,xxl:6,children:e.jsxs(u,{children:[e.jsx(f,{children:e.jsx("strong",{children:"School Breakdown of Event Male Athletes"})}),e.jsx(p,{children:e.jsx(M,{dataset:r,event:s})})]})}),e.jsx(i,{xs:12,sm:12,xl:6,xxl:6,children:e.jsxs(u,{children:[e.jsx(f,{children:e.jsx("strong",{children:"School Breakdown of Event Female Athletes"})}),e.jsx(p,{children:e.jsx(M,{dataset:o,event:s})})]})})]}),e.jsx("br",{}),e.jsxs(m,{xs:{gutter:3},children:[e.jsx(i,{xs:12,sm:12,xl:6,xxl:6,children:e.jsxs(u,{children:[e.jsxs(f,{children:[e.jsx("strong",{children:s})," - Male"]}),e.jsx(p,{children:e.jsxs(O,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(B,{children:e.jsxs(S,{children:[e.jsx(x,{scope:"col",children:"Rank"}),e.jsx(x,{scope:"col",children:"School"}),e.jsx(x,{scope:"col",children:"Name"}),e.jsx(x,{scope:"col",children:"Score"})]})}),e.jsx(D,{children:P(r,s).map((n,E)=>e.jsxs(S,{children:[e.jsx(d,{children:n.rank}),e.jsx(d,{children:n.school}),e.jsx(d,{children:n.name}),e.jsx(d,{children:n.score})]},`${E}_male`))})]})})]})}),e.jsx(i,{xs:12,sm:12,xl:6,xxl:6,children:e.jsxs(u,{children:[e.jsxs(f,{children:[e.jsx("strong",{children:s})," - Female"]}),e.jsx(p,{children:e.jsxs(O,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(B,{children:e.jsxs(S,{children:[e.jsx(x,{scope:"col",children:"Rank"}),e.jsx(x,{scope:"col",children:"School"}),e.jsx(x,{scope:"col",children:"Name"}),e.jsx(x,{scope:"col",children:"Score"})]})}),e.jsx(D,{children:P(o,s).map((n,E)=>e.jsxs(S,{children:[e.jsx(d,{children:n.rank}),e.jsx(d,{children:n.school}),e.jsx(d,{children:n.name}),e.jsx(d,{children:n.score})]},`${E}_female`))})]})})]})})]})]})}return e.jsxs(e.Fragment,{children:[e.jsx(m,{children:e.jsx(i,{xs:12,children:e.jsxs(N,{color:"info",children:["Scores as of ",_,". To update scores, refresh this page or wait 1 minute."]})})}),e.jsx(m,{children:e.jsx(i,{xs:12,children:e.jsxs(u,{className:"mb-4",children:[e.jsx(f,{children:e.jsx("strong",{children:"Event Filters"})}),e.jsxs(p,{children:[e.jsx(m,{children:e.jsxs(R,{className:"mb-3",children:[e.jsx($,{style:{width:"75px"},children:"Type: "}),e.jsxs(I,{value:a,onChange:r=>{c(r.target.value),l("")},children:[e.jsx("option",{value:"",children:"*"}),[...new Set(Object.values(F))].map((r,o)=>e.jsx("option",{value:r,children:r},o))]})]})}),e.jsx(m,{children:e.jsxs(R,{className:"mb-3",children:[e.jsx($,{style:{width:"75px"},children:"Event: "}),e.jsxs(I,{value:s,onChange:r=>l(r.target.value),children:[e.jsx("option",{value:"",children:"*"}),Object.keys(T).sort().map((r,o)=>e.jsx("option",{value:r,children:r},o))]})]})}),e.jsx("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:e.jsx(K,{style:{},color:"primary",onClick:()=>{c(""),l("")},children:"Reset Filters"})})]})]})})}),A]})},M=({dataset:a,event:c})=>{let s={};a.map(t=>{t.events.map(h=>{h.form===c&&(s[t.school]||(s[t.school]=0),s[t.school]+=1)})});let l=[];return Object.entries(s).forEach(([t,h])=>{l.push({value:h,label:t})}),e.jsx(q,{margin:{left:80},series:[{data:l,highlightScope:{faded:"global",highlighted:"item"},faded:{innerRadius:30,additionalRadius:-30,color:"gray"}}],height:300,slotProps:{legend:{hidden:!0}}})},z=(a,c)=>Object.fromEntries(Object.entries(a).filter(([s,l])=>l===c));function y(a,c){let s=0,l=0;a.map(h=>{h.events.map(g=>{g.form===c&&(s+=g.score,l++)})});const t=l!==0?s/l:0;return Math.round(t*100)/100}function P(a,c){let s=[];return a.map(l=>{l.events.map(t=>{t.form===c&&s.push({school:l.school,name:l.athlete,score:t.score})})}),s=s.sort((l,t)=>t.score-l.score),s.map((l,t)=>{l.rank=t+1}),s}export{me as default};
