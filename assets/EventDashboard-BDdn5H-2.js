import{r as v,j as e}from"./index-Bsvrp4C4.js";import{e as N,g as G}from"./getData-DLaOjktY.js";import{s as J}from"./sortStandings-Cn9dMIH5.js";import{c as C}from"./calculatePercentage-DVNjjR0D.js";import{C as k}from"./CAlert-CYNsQOT0.js";import{C as W}from"./CAlertLink-XMnrDeC1.js";import{C as m,a as i}from"./CRow-C_UyvV6X.js";import{C as b}from"./CWidgetStatsB-Bh1uS6rB.js";import{C as p,a as u}from"./CCardBody-D_1wkhn3.js";import{C as f}from"./CCardHeader-Cwhi9V89.js";import{C as O,a as B,b as S,c as x,d as D,e as d}from"./CTable-DQLBBuMb.js";import{C as R,a as $}from"./CInputGroupText-XAeOZtQg.js";import{C as I}from"./CFormSelect-B6uOAUFB.js";import{a as K}from"./index.es-Hqjms8rZ.js";import{P as q}from"./PieChart-BnnhuX9Q.js";import"./DefaultLayout-MkPcxr-p.js";import"./CProgress-p_bZVHnx.js";import"./CFormControlWrapper-DJO2rOYD.js";import"./CFormControlValidation-Dz4WHWu6.js";import"./CFormLabel-w58t7XaW.js";const je=()=>{const[a,c]=v.useState(""),[s,l]=v.useState(""),[t,h]=v.useState({athleteData:{},schools:[],loading:!0,error:null});v.useEffect(()=>{const r=()=>{G().then(o=>{h(o)}).catch(o=>{h({athleteData:{},schools:[],loading:!0,error:null})})};r();const n=setInterval(r,1*60*1e3);return()=>clearInterval(n)},[h]);const{athleteData:g,loading:H,error:L,syncDate:_}=t;let j=J(g);const E=j.filter(r=>r.gender==="Male").length,w=j.filter(r=>r.gender==="Female").length;let T=N;if(a!==""&&(T=z(N,a)),s!==""&&(j=j.filter(r=>r.events.some(n=>n.form===s))),H)return e.jsx("div",{children:"Loading..."});if(L)return e.jsxs(k,{color:"danger",children:["An error has occurred getting scores, refresh this page. If this problem continues to persist, contact Khai Nguyen and check the ",e.jsx(W,{href:"https://bowuu.com/all-results",target:"_blank",children:"Official Total Scores"}),"."]});let A=null;if(s==="")A=e.jsx(k,{color:"danger",children:"Select an Event."});else{let r=[],n=[];j.forEach(o=>{o.gender==="Male"?r.push(o):o.gender==="Female"&&n.push(o)}),A=e.jsxs(e.Fragment,{children:[e.jsxs(m,{xs:{gutter:3},children:[e.jsx(i,{xs:12,sm:6,xl:3,xxl:3,children:e.jsx(b,{className:"mb-3",color:"white",progress:{value:C(r.length,E)},text:"",title:"Number of Male Athletes",value:`${r.length} / ${E}`})}),e.jsx(i,{xs:12,sm:6,xl:3,xxl:3,children:e.jsx(b,{className:"mb-3",color:"white",progress:{value:C(y(r,s),10)},text:"",title:"Average Barehand Score",value:`${y(r,s)} / 10.00`})}),e.jsx(i,{xs:12,sm:6,xl:3,xxl:3,children:e.jsx(b,{className:"mb-3",color:"white",progress:{value:C(n.length,w)},text:"",title:"Number of Female Athletes",value:`${n.length} / ${w}`})}),e.jsx(i,{xs:12,sm:6,xl:3,xxl:3,children:e.jsx(b,{className:"mb-3",color:"white",progress:{value:C(y(n,s),10)},text:"",title:"Average Long Weapon Score",value:`${y(n,s)} / 10.00`})})]}),e.jsx("br",{}),e.jsxs(m,{xs:{gutter:3},children:[e.jsx(i,{xs:12,sm:12,xl:6,xxl:6,children:e.jsxs(p,{children:[e.jsx(f,{children:e.jsx("strong",{children:"School Breakdown of Event Male Athletes"})}),e.jsx(u,{children:e.jsx(M,{dataset:r,event:s})})]})}),e.jsx(i,{xs:12,sm:12,xl:6,xxl:6,children:e.jsxs(p,{children:[e.jsx(f,{children:e.jsx("strong",{children:"School Breakdown of Event Female Athletes"})}),e.jsx(u,{children:e.jsx(M,{dataset:n,event:s})})]})})]}),e.jsx("br",{}),e.jsxs(m,{xs:{gutter:3},children:[e.jsx(i,{xs:12,sm:12,xl:6,xxl:6,children:e.jsxs(p,{children:[e.jsxs(f,{children:[e.jsx("strong",{children:s})," - Male"]}),e.jsx(u,{children:e.jsxs(O,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(B,{children:e.jsxs(S,{children:[e.jsx(x,{scope:"col",children:"Rank"}),e.jsx(x,{scope:"col",children:"School"}),e.jsx(x,{scope:"col",children:"Name"}),e.jsx(x,{scope:"col",children:"Score"})]})}),e.jsx(D,{children:P(r,s).map((o,F)=>e.jsxs(S,{children:[e.jsx(d,{children:o.rank}),e.jsx(d,{children:o.school}),e.jsx(d,{children:o.name}),e.jsx(d,{children:o.score})]},`${F}_male`))})]})})]})}),e.jsx(i,{xs:12,sm:12,xl:6,xxl:6,children:e.jsxs(p,{children:[e.jsxs(f,{children:[e.jsx("strong",{children:s})," - Female"]}),e.jsx(u,{children:e.jsxs(O,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(B,{children:e.jsxs(S,{children:[e.jsx(x,{scope:"col",children:"Rank"}),e.jsx(x,{scope:"col",children:"School"}),e.jsx(x,{scope:"col",children:"Name"}),e.jsx(x,{scope:"col",children:"Score"})]})}),e.jsx(D,{children:P(n,s).map((o,F)=>e.jsxs(S,{children:[e.jsx(d,{children:o.rank}),e.jsx(d,{children:o.school}),e.jsx(d,{children:o.name}),e.jsx(d,{children:o.score})]},`${F}_female`))})]})})]})})]})]})}return e.jsxs(e.Fragment,{children:[e.jsx(m,{children:e.jsx(i,{xs:12,children:e.jsxs(k,{color:"info",children:["Scores as of ",_,". To update scores, refresh this page or wait 1 minute."]})})}),e.jsx(m,{children:e.jsx(i,{xs:12,children:e.jsxs(p,{className:"mb-4",children:[e.jsx(f,{children:e.jsx("strong",{children:"Total Score Filters"})}),e.jsxs(u,{children:[e.jsx(m,{children:e.jsxs(R,{className:"mb-3",children:[e.jsx($,{style:{width:"75px"},children:"Type: "}),e.jsxs(I,{value:a,onChange:r=>{c(r.target.value),l("")},children:[e.jsx("option",{value:"",children:"*"}),[...new Set(Object.values(N))].map((r,n)=>e.jsx("option",{value:r,children:r},n))]})]})}),e.jsx(m,{children:e.jsxs(R,{className:"mb-3",children:[e.jsx($,{style:{width:"75px"},children:"Event: "}),e.jsxs(I,{value:s,onChange:r=>l(r.target.value),children:[e.jsx("option",{value:"",children:"*"}),Object.keys(T).sort().map((r,n)=>e.jsx("option",{value:r,children:r},n))]})]})}),e.jsx("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:e.jsx(K,{style:{},color:"primary",onClick:()=>{c(""),l("")},children:"Reset Filters"})})]})]})})}),A]})},M=({dataset:a,event:c})=>{let s={};a.map(t=>{t.events.map(h=>{h.form===c&&(s[t.school]||(s[t.school]=0),s[t.school]+=1)})});let l=[];return Object.entries(s).forEach(([t,h])=>{l.push({value:h,label:t})}),e.jsx(q,{margin:{left:80},series:[{data:l,highlightScope:{faded:"global",highlighted:"item"},faded:{innerRadius:30,additionalRadius:-30,color:"gray"}}],height:300,slotProps:{legend:{hidden:!0}}})},z=(a,c)=>Object.fromEntries(Object.entries(a).filter(([s,l])=>l===c));function y(a,c){let s=0,l=0;a.map(h=>{h.events.map(g=>{g.form===c&&(s+=g.score,l++)})});const t=l!==0?s/l:0;return Math.round(t*100)/100}function P(a,c){let s=[];return a.map(l=>{l.events.map(t=>{t.form===c&&s.push({school:l.school,name:l.athlete,score:t.score})})}),s=s.sort((l,t)=>t.score-l.score),s.map((l,t)=>{l.rank=t+1}),s}export{je as default};
