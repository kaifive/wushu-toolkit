import{r as v,j as e}from"./index-SsvsGaRu.js";import{s as J,e as F,g as L}from"./sortStandings-y94oAdGl.js";import{c as C}from"./calculatePercentage-JLjSYE1v.js";import{C as N}from"./CAlert-CRMnC7Vh.js";import{C as K}from"./CAlertLink-Bqb5iy2M.js";import{C as m,a as i}from"./CRow-bipQ_taK.js";import{C as b}from"./CWidgetStatsB-u7N1qpo_.js";import{C as u,a as p}from"./CCardBody-Con7yruV.js";import{C as f}from"./CCardHeader-BbKgpHZR.js";import{C as w,a as D,b as S,c as x,d as R,e as d}from"./CTable-DqxKLAeV.js";import{C as B,a as M}from"./CInputGroupText-CXqUmc11.js";import{C as $}from"./CFormSelect-DiRrRav3.js";import{a as W}from"./index.es-B57CStmw.js";import{P as q}from"./PieChart-Cs2vi4wh.js";import"./DefaultLayout-Ch_5gT7A.js";import"./CProgress-FNqgkA7X.js";import"./CFormControlWrapper-BnOeLTqV.js";import"./CFormControlValidation-BtdKCfmC.js";import"./CFormLabel-DJXUkcfG.js";const me=()=>{const[a,c]=v.useState(""),[s,l]=v.useState(""),[t,h]=v.useState({athleteData:{},schools:[],loading:!0,error:null});v.useEffect(()=>{const r=()=>{L().then(n=>{h(n)}).catch(n=>{h({athleteData:{},schools:[],loading:!0,error:null})})};r();const o=setInterval(r,1*60*1e3);return()=>clearInterval(o)},[h]);const{athleteData:g,loading:H,error:_,syncDate:G}=t;let j=J(g);const k=j.filter(r=>r.gender==="Male").length,T=j.filter(r=>r.gender==="Female").length;let O=F;if(a!==""&&(O=z(F,a)),s!==""&&(j=j.filter(r=>r.events.some(o=>o.form===s))),H)return e.jsx("div",{children:"Loading..."});if(_)return e.jsxs(N,{color:"danger",children:["An error has occurred getting scores, refresh this page. If this problem continues to persist, contact Khai Nguyen and check the ",e.jsx(K,{href:"https://bowuu.com/all-results",target:"_blank",children:"Official Total Scores"}),"."]});let y=null;if(s==="")y=e.jsx(N,{color:"danger",children:"Select an Event."});else{let r=[],o=[];j.forEach(n=>{n.gender==="Male"?r.push(n):n.gender==="Female"&&o.push(n)}),y=e.jsxs(e.Fragment,{children:[e.jsxs(m,{xs:{gutter:3},children:[e.jsx(i,{xs:12,sm:6,xl:3,xxl:3,children:e.jsx(b,{className:"mb-3",progress:{value:C(r.length,k)},text:"",title:"Number of Male Athletes",value:`${r.length} / ${k}`})}),e.jsx(i,{xs:12,sm:6,xl:3,xxl:3,children:e.jsx(b,{className:"mb-3",progress:{value:C(E(r,s),10)},text:"",title:"Average Male Score in Event",value:`${E(r,s)} / 10.00`})}),e.jsx(i,{xs:12,sm:6,xl:3,xxl:3,children:e.jsx(b,{className:"mb-3",progress:{value:C(o.length,T)},text:"",title:"Number of Female Athletes",value:`${o.length} / ${T}`})}),e.jsx(i,{xs:12,sm:6,xl:3,xxl:3,children:e.jsx(b,{className:"mb-3",progress:{value:C(E(o,s),10)},text:"",title:"Average Female Score in Event",value:`${E(o,s)} / 10.00`})})]}),e.jsx("br",{}),e.jsxs(m,{xs:{gutter:3},children:[e.jsx(i,{xs:12,sm:12,xl:6,xxl:6,children:e.jsxs(u,{children:[e.jsx(f,{children:e.jsx("strong",{children:"School Breakdown of Event Male Athletes"})}),e.jsx(p,{children:e.jsx(I,{dataset:r,event:s})})]})}),e.jsx(i,{xs:12,sm:12,xl:6,xxl:6,children:e.jsxs(u,{children:[e.jsx(f,{children:e.jsx("strong",{children:"School Breakdown of Event Female Athletes"})}),e.jsx(p,{children:e.jsx(I,{dataset:o,event:s})})]})})]}),e.jsx("br",{}),e.jsxs(m,{xs:{gutter:3},children:[e.jsx(i,{xs:12,sm:12,xl:6,xxl:6,children:e.jsxs(u,{children:[e.jsxs(f,{children:[e.jsx("strong",{children:s})," - Male"]}),e.jsx(p,{children:e.jsxs(w,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(D,{children:e.jsxs(S,{children:[e.jsx(x,{scope:"col",children:"Rank"}),e.jsx(x,{scope:"col",children:"School"}),e.jsx(x,{scope:"col",children:"Name"}),e.jsx(x,{scope:"col",children:"Score"})]})}),e.jsx(R,{children:P(r,s).map((n,A)=>e.jsxs(S,{children:[e.jsx(d,{children:n.rank}),e.jsx(d,{children:n.school}),e.jsx(d,{children:n.name}),e.jsx(d,{children:n.score})]},`${A}_male`))})]})})]})}),e.jsx(i,{xs:12,sm:12,xl:6,xxl:6,children:e.jsxs(u,{children:[e.jsxs(f,{children:[e.jsx("strong",{children:s})," - Female"]}),e.jsx(p,{children:e.jsxs(w,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(D,{children:e.jsxs(S,{children:[e.jsx(x,{scope:"col",children:"Rank"}),e.jsx(x,{scope:"col",children:"School"}),e.jsx(x,{scope:"col",children:"Name"}),e.jsx(x,{scope:"col",children:"Score"})]})}),e.jsx(R,{children:P(o,s).map((n,A)=>e.jsxs(S,{children:[e.jsx(d,{children:n.rank}),e.jsx(d,{children:n.school}),e.jsx(d,{children:n.name}),e.jsx(d,{children:n.score})]},`${A}_female`))})]})})]})})]})]})}return e.jsxs(e.Fragment,{children:[e.jsx(m,{children:e.jsx(i,{xs:12,children:e.jsxs(N,{color:"info",children:["Scores as of ",G,". To update scores, refresh this page or wait 1 minute."]})})}),e.jsx(m,{children:e.jsx(i,{xs:12,children:e.jsxs(u,{className:"mb-4",children:[e.jsx(f,{children:e.jsx("strong",{children:"Event Filters"})}),e.jsxs(p,{children:[e.jsx(m,{children:e.jsxs(B,{className:"mb-3",children:[e.jsx(M,{style:{width:"75px"},children:"Type: "}),e.jsxs($,{value:a,onChange:r=>{c(r.target.value),l("")},children:[e.jsx("option",{value:"",children:"*"}),[...new Set(Object.values(F))].map((r,o)=>e.jsx("option",{value:r,children:r},o))]})]})}),e.jsx(m,{children:e.jsxs(B,{className:"mb-3",children:[e.jsx(M,{style:{width:"75px"},children:"Event: "}),e.jsxs($,{value:s,onChange:r=>l(r.target.value),children:[e.jsx("option",{value:"",children:"*"}),Object.keys(O).sort().map((r,o)=>e.jsx("option",{value:r,children:r},o))]})]})}),e.jsx("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:e.jsx(W,{style:{},color:"primary",onClick:()=>{c(""),l("")},children:"Reset Filters"})})]})]})})}),y]})},I=({dataset:a,event:c})=>{let s={};a.map(t=>{t.events.map(h=>{h.form===c&&(s[t.school]||(s[t.school]=0),s[t.school]+=1)})});let l=[];return Object.entries(s).forEach(([t,h])=>{l.push({value:h,label:t})}),e.jsx(q,{margin:{left:80},series:[{data:l,highlightScope:{faded:"global",highlighted:"item"},faded:{innerRadius:30,additionalRadius:-30,color:"gray"}}],height:300,slotProps:{legend:{hidden:!0}}})},z=(a,c)=>Object.fromEntries(Object.entries(a).filter(([s,l])=>l===c));function E(a,c){let s=0,l=0;a.map(h=>{h.events.map(g=>{g.form===c&&(s+=g.score,l++)})});const t=l!==0?s/l:0;return Math.round(t*100)/100}function P(a,c){let s=[];return a.map(l=>{l.events.map(t=>{t.form===c&&s.push({school:l.school,name:l.athlete,score:t.score})})}),s=s.sort((l,t)=>t.score-l.score),s.map((l,t)=>{l.rank=t+1}),s}export{me as default};
