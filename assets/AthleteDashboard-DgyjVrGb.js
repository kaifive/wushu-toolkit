import{r as A,k as Q,j as e}from"./index-SsvsGaRu.js";import{c as D,a as V}from"./index.es-B57CStmw.js";import{s as W,g as X}from"./sortStandings-y94oAdGl.js";import{c as p,a as S}from"./calculatePercentage-JLjSYE1v.js";import{C}from"./CAlert-CRMnC7Vh.js";import{C as Y}from"./CAlertLink-Bqb5iy2M.js";import{C as u,a as c}from"./CRow-bipQ_taK.js";import{C as g}from"./CWidgetStatsB-u7N1qpo_.js";import{C as y,a as B}from"./CCardBody-Con7yruV.js";import{C as T}from"./CCardHeader-BbKgpHZR.js";import{C as I}from"./CWidgetStatsF-Daz6bqh3.js";import{c as R}from"./cil-chart-pie-DAJ2n9ge.js";import{C as U,a as E}from"./CInputGroupText-CXqUmc11.js";import{C as K}from"./CFormSelect-DiRrRav3.js";import{B as Z}from"./BarChart-DDcannap.js";import"./DefaultLayout-Ch_5gT7A.js";import"./CProgress-FNqgkA7X.js";import"./CCardFooter-almlB9Va.js";import"./CFormControlWrapper-BnOeLTqV.js";import"./CFormControlValidation-BtdKCfmC.js";import"./CFormLabel-DJXUkcfG.js";const ve=()=>{const[a,n]=A.useState(""),[t,s]=A.useState(""),[d,o]=A.useState({athleteData:{},schools:[],loading:!0,error:null});A.useEffect(()=>{const l=()=>{X().then(M=>{o(M)}).catch(M=>{o({athleteData:{},schools:[],loading:!0,error:null})})};l();const h=setInterval(l,1*60*1e3);return()=>clearInterval(h)},[o]);const{colorMode:i,setColorMode:ee}=Q("coreui-free-react-admin-template-theme"),J=i==="dark"?{[`.${S.root}`]:{[`.${S.tick}, .${S.line}`]:{stroke:"white",strokeWidth:3},[`.${S.tickLabel}`]:{fill:"white"}},".MuiChartsGrid-horizontalLine":{stroke:"white"},".MuiChartsLegend-series text":{color:"white !important",fill:"white !important"}}:{},G={height:300,sx:{[`.${S.left} .${S.label}`]:{transform:"translate(-20px, 0)"},...J}},{athleteData:v,schools:O,athletes:P,loading:H,error:_,syncDate:q}=d;let $=P,r=W(v);if(a!==""&&(r=r.filter(l=>l.school===a),$=$.filter(l=>l.school===a)),t!==""&&(r=r.filter(l=>l.athlete===t)),H)return e.jsx("div",{children:"Loading..."});if(_)return e.jsxs(C,{color:"danger",children:["An error has occurred getting scores, refresh this page. If this problem continues to persist, contact Khai Nguyen and check the ",e.jsx(Y,{href:"https://bowuu.com/all-results",target:"_blank",children:"Official Total Scores"}),"."]});let k=null;r=r[0];let x=null,f=null,m=W(v);if(t==="")k=e.jsx(C,{color:"danger",children:"Select an Athlete."});else{x=W(v).filter(h=>h.group===r.group),x=x.filter(h=>h.gender===r.gender),f=W(v).filter(h=>h.gender===r.gender);const l=r.group==="A"?9:6;k=e.jsxs(e.Fragment,{children:[e.jsxs(u,{xs:{gutter:3},children:[e.jsx(c,{xs:12,sm:6,xl:3,xxl:3,children:e.jsx(g,{className:"mb-3",progress:{value:p(r.topEvents.Barehand.score,10)},text:L(r,"Barehand"),title:"Top Barehand Score",value:`${b(r,"Barehand")} / 10.00`})}),e.jsx(c,{xs:12,sm:6,xl:3,xxl:3,children:e.jsx(g,{className:"mb-3",progress:{value:p(b(r,"Short Weapon"),10)},text:L(r,"Short Weapon"),title:"Top Short Weapon Score",value:`${b(r,"Short Weapon")} / 10.00`})}),e.jsx(c,{xs:12,sm:6,xl:3,xxl:3,children:e.jsx(g,{className:"mb-3",progress:{value:p(b(r,"Long Weapon"),10)},text:L(r,"Long Weapon"),title:"Top Long Weapon Score",value:`${b(r,"Long Weapon")} / 10.00`})}),e.jsx(c,{xs:12,sm:6,xl:3,xxl:3,children:e.jsx(g,{className:"mb-3",progress:{value:p(r.finalScore,20)},text:"Top Barehand + Top Weapon",title:"Combined Score",value:`${r.finalScore} / 20.00`})})]}),e.jsx("br",{}),e.jsxs(u,{xs:{gutter:3},children:[e.jsx(c,{xs:12,sm:12,xl:4,xxl:4,children:e.jsx(g,{className:"mb-3",progress:{value:p(x.length-j(r,x)+1,x.length)},text:"Ranking in Group & Gender",value:`#${j(r,x)} of ${x.length}`})}),e.jsx(c,{xs:12,sm:12,xl:4,xxl:4,children:e.jsx(g,{className:"mb-3",progress:{value:p(f.length-j(r,f)+1,f.length)},text:"Ranking in Gender",value:`#${j(r,f)} of ${f.length}`})}),e.jsx(c,{xs:12,sm:12,xl:4,xxl:4,children:e.jsx(g,{className:"mb-3",progress:{value:p(m.length-j(r,m)+1,m.length)},text:"Ranking in USA",value:`#${j(r,m)} of ${m.length}`})})]}),e.jsx("br",{}),e.jsx(u,{children:e.jsx(c,{xs:12,sm:12,xl:12,xxl:12,children:e.jsxs(y,{children:[e.jsxs(T,{children:[e.jsx("strong",{children:"Athlete Barehand Score Comparison"})," ",e.jsx("br",{}),"Average Overall Barehand Score in Group & Gender: ",F(x,"Barehand")]}),e.jsx(B,{children:e.jsx(w,{dataset:N(r,m,"Barehand"),chartSetting:G})})]})})}),e.jsx("br",{}),e.jsxs(u,{xs:{gutter:3},children:[e.jsx(c,{xs:12,sm:12,xl:6,xxl:6,children:e.jsxs(y,{children:[e.jsxs(T,{children:[e.jsx("strong",{children:"Athlete Short Weapon Score Comparison"}),e.jsx("br",{}),"Average Overall Short Weapon Score in Group & Gender: ",F(x,"Short Weapon")]}),e.jsx(B,{children:e.jsx(w,{dataset:N(r,m,"Short Weapon"),chartSetting:G})})]})}),e.jsx(c,{xs:12,sm:12,xl:6,xxl:6,children:e.jsxs(y,{children:[e.jsxs(T,{children:[e.jsx("strong",{children:"Athlete Long Weapon Score Comparison"}),e.jsx("br",{}),"Average Overall Long Weapon Score in Group & Gender: ",F(x,"Long Weapon")]}),e.jsx(B,{children:e.jsx(w,{dataset:N(r,m,"Long Weapon"),chartSetting:G})})]})})]}),e.jsx("br",{}),e.jsxs(u,{xs:{gutter:3},children:[e.jsx(c,{xs:12,sm:12,xl:6,xxl:6,children:e.jsx(I,{icon:e.jsx(D,{width:24,icon:R,size:"xl"}),title:"Average Barehand Score",padding:!1,value:`${z(r,"Barehand")} / 10.00`,color:"primary"})}),e.jsx(c,{xs:12,sm:12,xl:6,xxl:6,children:e.jsx(I,{icon:e.jsx(D,{width:24,icon:R,size:"xl"}),title:"Average Weapon Score",padding:!1,value:`${z(r,"Weapon")} / 10.00`,color:"primary"})})]}),e.jsx("br",{}),j(r,x)<l?e.jsxs(C,{color:"primary",children:[e.jsx("strong",{children:"US Junior Wushu Team Standing"}),e.jsx("br",{}),"Congratulations, ",r.athlete," is currently on the 2024 US Junior Wushu Team!"]}):e.jsxs(C,{color:"warning",children:[e.jsx("strong",{children:"US Junior Wushu Team Standing"}),e.jsx("br",{}),"Unfortunately, ",r.athlete," is currently not on the 2024 US Junior Wushu Team. "]}),e.jsx("br",{})]})}return e.jsxs(e.Fragment,{children:[e.jsx(u,{children:e.jsx(c,{xs:12,children:e.jsxs(C,{color:"info",children:["Scores as of ",q,". To update scores, refresh this page or wait 1 minute."]})})}),e.jsx(u,{children:e.jsx(c,{xs:12,children:e.jsxs(y,{className:"mb-4",children:[e.jsx(T,{children:e.jsx("strong",{children:"Total Score Filters"})}),e.jsxs(B,{children:[e.jsx(u,{children:e.jsxs(U,{className:"mb-3",children:[e.jsx(E,{style:{width:"75px"},children:"School: "}),e.jsxs(K,{value:a,onChange:l=>{n(l.target.value),s("")},children:[e.jsx("option",{value:"",children:"*"}),O.map((l,h)=>e.jsx("option",{value:l,children:l},h))]})]})}),e.jsx(u,{children:e.jsxs(U,{className:"mb-3",children:[e.jsx(E,{style:{width:"75px"},children:"Athlete: "}),e.jsxs(K,{value:t,onChange:l=>s(l.target.value),children:[e.jsx("option",{value:"",children:"*"}),$.map((l,h)=>e.jsx("option",{value:l.name,children:l.name},h))]})]})}),e.jsx("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:e.jsx(V,{style:{},color:"primary",onClick:()=>{n(""),s("")},children:"Reset Filters"})})]})]})})}),k]})},w=({dataset:a,chartSetting:n})=>e.jsx(Z,{dataset:a,xAxis:[{scaleType:"band",dataKey:"label"}],yAxis:[{max:10}],series:[{dataKey:"athlete",label:"Athlete Score",color:"#1b9e3e"},{dataKey:"group",label:"Group Average",color:"#3399ff"},{dataKey:"gender",label:"Group & Gender Average",color:"#e55353"}],grid:{horizontal:!0},...n});function b(a,n){let t=0;return a.events.map(s=>{s.class===n&&s.score>t&&(t=s.score)}),t}function L(a,n){let t=0,s="Not Applicable";return a.events.map(d=>{d.class===n&&d.score>t&&(t=d.score,s=d.form)}),s}function j(a,n){let t=1;for(const s of n){if(s.athlete===a.athlete)return t;t+=1}return null}function z(a,n){let t=0,s=0;a.events.forEach(o=>{o.class.includes(n)&&(t=t+o.score,s++)});const d=s!==0?t/s:0;return Math.round(d*100)/100}function N(a,n,t){let s={};n.map(o=>{o.group===a.group&&o.events.map(i=>{i.class===t&&(s[i.form]||(s[i.form]={groupTotalScore:0,groupCount:0,genderTotalScore:0,genderCount:0}),o.gender===a.gender&&(s[i.form].genderTotalScore+=i.score,s[i.form].genderCount++),s[i.form].groupTotalScore+=i.score,s[i.form].groupCount++)})});let d=[];return a.events.map(o=>{o.class===t&&d.push({label:o.form,athlete:o.score,group:s[o.form].groupCount!==0?Math.round(s[o.form].groupTotalScore/s[o.form].groupCount*100)/100:0,gender:s[o.form].genderCount!==0?Math.round(s[o.form].genderTotalScore/s[o.form].genderCount*100)/100:0})}),d}function F(a,n){let t=0,s=0;a.map(o=>{o.events.map(i=>{i.class===n&&(t+=i.score,s++)})});const d=s!==0?t/s:0;return Math.round(d*100)/100}export{ve as default};
